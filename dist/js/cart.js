"use strict";$(function(){if(!getCookie("nickname"))return window.location.href="./login.html";var o=JSON.parse(window.localStorage.getItem("cart"))||[];if(!o.length)return $(".on").addClass("hide"),void $(".off").removeClass("hide");function a(){var n=o.every(function(n){return"1"===n.is_select}),t=0,a=0;o.forEach(function(n){"1"===n.is_select&&(t+=+n.cart_number,a+=n.cart_number*n.goods_price)});var c='\n      <div class="panel panel-info">\n        <div class="panel-heading">\n          <p class="selectAll">\n            <span>全选:</span>\n            <input type="checkbox" '.concat(n?"checked":"",'>\n            <span class="text">购 物 清 单</span>\n          </p>\n        </div>\n        <div class="panel-body">\n          <ul class="goodsList">\n    ');o.forEach(function(n){c+='\n        <li>\n          <div class="select">\n            <input data-id="'.concat(n.goods_id,'" type="checkbox" ').concat("1"===n.is_select?"checked":"",'>\n          </div>\n          <div class="goodsImg">\n            <img src="').concat(n.goods_img1,'" alt="" style="width:100%;margin-top:-5px;">\n          </div>\n          <div class="goodsDesc">\n            <p>').concat(n.goods_name,'</p>\n          </div>\n          <div class="price">\n             <span class="text-danger">').concat(n.goods_price,'</span>\n          </div>\n          <div class="count">\n            <button class="subNum" data-id="').concat(n.goods_id,'">-</button>\n            <input type="text" value="').concat(n.cart_number,'">\n            <button class="addNum" data-id="').concat(n.goods_id,'">+</button>\n          </div>\n          <div class="xiaoji">\n            ￥ <span class="text-danger">').concat((n.goods_price*n.cart_number).toFixed(2),'</span>\n          </div>\n          <div class="operate">\n            <button class="btn btn-danger del" data-id="').concat(n.goods_id,'">删除</button>\n          </div>\n        </li>\n      ')}),c+='\n          </ul>\n        </div>\n        <div class="panel-footer">\n          <div class="row buyInfo">\n            <p class="col-sm-4 buyNum">\n              购买总数量: <span class="text-danger cartNum">'.concat(t,'</span> 件商品\n            </p>\n            <p class="col-sm-4 buyMoney">\n              购买总价格: <span class="text-danger total">').concat(a.toFixed(2),'</span> 元\n            </p>\n            <p class="col-sm-4 operate">\n              <button class="btn btn-success" ').concat(0===a?"":"disabled",'>立即付款</button>\n              <button class="btn btn-danger">清空购物车</button>\n              <button class="btn btn-primary">继续购物</button>\n            </p>\n          </div>\n        </div>\n      </div>\n    '),$(".on").html(c)}$(".off").addClass("hide"),$(".on").removeClass("hide"),a(),$(".on").on("click",".select > input",function(){var n=this.checked,t=$(this).data("id");o.filter(function(n){return n.goods_id==t})[0].is_select=n?"1":"0",a(),window.localStorage.setItem("cart",JSON.stringify(o))}),$(".on").on("click",".addNum",function(){var t=$(this).data("id"),n=o.filter(function(n){return n.goods_id==t})[0];n.cart_number=+n.cart_number+1,a(),window.localStorage.setItem("cart",JSON.stringify(o))}),$(".on").on("click",".subNum",function(){var t=$(this).data("id"),n=o.filter(function(n){return n.goods_id==t})[0];1!==n.cart_number&&(n.cart_number=+n.cart_number-1,a(),window.localStorage.setItem("cart",JSON.stringify(o)))}),$(".on").on("click",".del",function(){for(var n=$(this).data("id"),t=0;t<o.length;t++)if(o[t].goods_id==n){o.splice(t,1);break}if(a(),window.localStorage.setItem("cart",JSON.stringify(o)),!o.length)return window.location.reload()}),$(".on").on("click",".selectAll > input",function(){if(this.checked)for(var n=0;n<o.length;n++)o[n].is_select="1";else for(var t=0;t<o.length;t++)o[t].is_select="0";a(),window.localStorage.setItem("cart",JSON.stringify(o))})});